
<script>
    TravelNxt = window.TravelNxt || {};
    TravelNxt.Behaviors = TravelNxt.Behaviors || {};
    TravelNxt.Behaviors.FareBehavior = {
        properties: {
            /*Fare components from API*/
            _components: {
                type: Array,
                value: function() {
                    return [];
                }
            },

            _currency:{
                type: String,
                notify: false,
                computed: '_getCurrency(_components)'
            },

            _baseFare: {
                type: Object,
                notify: false,
                computed: '_computeFare(_components, "basefare")'
            },

            _discount: {
                type: Object,
                notify: false,
                computed: '_computeFare(_components, "totaldiscount")'
            },

            _savings: {
                type: Object,
                notify: false,
                computed: '_computeFare(_components, "totalsaving")'
            },

            _baseFareWithoutSavings: {
                type: Object,
                notify: false,
                computed: '_computeFareWithoutSavings(_baseFare, _savings)'
            },

            _baseFareWithDiscount: {
                type: Object,
                notify: false,
                computed: '_computeFareWithDiscount(_baseFare, _discount)'
            }
        },

        _computeFare: function(components, type){
            if(components){
                for (var i = 0; i < components.length; i++) {
                    var comp = components[i];
                    if(comp.type.toLowerCase() == type.toLowerCase())
                        return comp;
                };
            }
            return null;
        },

        _computeFareWithoutSavings: function(_baseFare, _savings){
            if(!_baseFare)
                return null;

            var fare = {
                    money: {
                        amount: _baseFare.money.amount,
                        currency: _baseFare.money.currency,
                        displayAmount: ''  //set formatted value after intergating globalization
                    }
                };

            if(_savings){
                fare.money.amount += _savings.money.amount;
            }
            return fare;
        },

        _computeFareWithDiscount: function(_baseFare, _discount){
            if(!_baseFare)
                return null;

            var fare = {
                    money: {
                        amount: _baseFare.money.amount,
                        currency: _baseFare.money.currency,
                        displayAmount: ''  //set formatted value after intergating globalization
                    }
                };

            if(_discount){
                fare.money.amount -= _discount.money.amount;
            }
            return fare;
        },

        _getCurrency:function (_components) {
            if(!_components || !_components.length){
                return '';
            }
            if (!_components[0].money) {
                return '';
            }
            return _components[0].money.currency;
        }
    };
</script>
