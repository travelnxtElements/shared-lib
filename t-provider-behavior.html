

<script>
    TravelNxt = window.TravelNxt || {};
    TravelNxt.Behaviors = TravelNxt.Behaviors || {};
    TravelNxt.Behaviors.ProviderBehavior = {
        properties: {
            /*
            API base url. Ex http://demo.travelnxt.com
             */
            apiBaseUrl: String,
            /*
            API relative url. Ex /api/hotel/search
             */
            apiRelativeUrl: String,
            /*
            Key values to be set in api url query string
             */
            queryParams: Array,
            /*
            API authentication token, this will be appended to url as per Mystique standards
             */
            authToken: String,
            /*
            API in progress stage
             */
            loading: {
                type: Boolean,
                notify: true,
                readOnly: true,
                value: false
            },


            /*
            Most recent request's API success response, not iron-ajax last response
             */
            lastResponse: {
                type: Object,
                notify: true,
                readOnly: true
            },

            
            /*
            Most recent request's API error or network error, not iron-ajax last response
            Translate all network errors to below given format
            Sample error object
            {
                "code": Number,
                "message": String,
                "additionalMessages": [
                  {
                    "description": String,
                    "code": Number,
                    "message": String
                  }
                ]
            }
             */
            lastError: {
                type: Object,
                notify: true,
                readOnly: true
            }
        },

        _getUrl: function(){  
            //sanitize urls before use
            if(!this.apiBaseUrl && this.apiBaseUrl.lastIndexOf('/') == this.apiBaseUrl.length -1){                
                this.set('apiBaseUrl', this.apiBaseUrl.substring(0, this.apiBaseUrl.length - 1));
            }  
            if(!this.apiRelativeUrl && this.apiRelativeUrl.firstIndexOf('/') != 0){                
                this.set('apiRelativeUrl', '/' + this.apiRelativeUrl);
            }        
            return this.apiBaseUrl +  this.apiRelativeUrl + '?token=' + this.authToken;
        },

        _validateApiMeta: function(){            
            if(!this.apiBaseUrl){
                console.error('apiBaseUrl can\'t be empty');
                return false;
            }
            else if(!this.apiRelativeUrl){
                console.error('apiRelativeUrl can\'t be empty');
                return false;
            }
            else if(!this.authToken){
                console.error('authToken can\'t be empty');
                return false;
            }
            return true;            
        }
    };
</script>
